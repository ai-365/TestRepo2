<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #container {
            width: 30vw;
            height: 30vw;
            padding: 20px;
            background: pink;
        }
    </style>
</head>

<body>
    <h1><a href="./本地文件.html">本地文件</a></h1>
    <h1><a href="本地文件.html">测试页面</a></h1>
    <textarea name="input-area" id="input-area"></textarea>
    <iframe width=500px src="https://ai-365.github.io/ai-app/" frameborder="0"></iframe>
    <div id="container"></div>
    <script type="module">
        const container = document.querySelector('#container')
        // 注册Service Worker
        // await navigator.serviceWorker.register('./service-worker.js')

        const rootHandle = await navigator.storage.getDirectory()
        // const dirHandle = await rootHandle.getDirectoryHandle('firstDir', { create: true })

        // 创建第一个文件firstFile.html，不存在就新建
        const fileHandle = await rootHandle.getFileHandle('测试页面.html', { create: true })

        const inputArea = document.querySelector('#input-area')
        inputArea.oninput = async () => {
            // 基于该文件创建写入流
            const writable = await fileHandle.createWritable()
            // // 写入内容
            writable.write(inputArea.value)
            writable.close()
        }

        // setInterval(async () => {
        //     const file = await fileHandle.getFile()
        //     container.innerHTML = await file.text()
        // }, 1000)



        // 关闭
        // writable.close()

        for await (let [name, handle] of rootHandle) {
            console.log(name)
        }

        const file = await fileHandle.getFile()
        console.log(await file.text())

        // await (await navigator.storage.getDirectory()).remove({ recursive: true });

        // await fetch('./测试页面.html', { cache: 'force-cache' })


    </script>
</body>

</html>